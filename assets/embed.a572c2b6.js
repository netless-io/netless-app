import"./modulepreload-polyfill.c7c6310f.js";var X=Object.defineProperty,H=(h,e,s)=>e in h?X(h,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):h[e]=s,d=(h,e,s)=>(H(h,typeof e!="symbol"?e+"":e,s),s);const U="!#%()*+,-./:;=?@[]^_`{|}~ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",J=U.length,W=Array(20),Q=()=>{for(let h=0;h<20;h++)W[h]=U.charAt(Math.random()*J);return W.join("")};function $(h){try{return h()}catch(e){console.error(e)}}class Y{constructor(){this.disposers=new Map}addDisposer(e,s=this.genUID()){return this.flush(s),this.disposers.set(s,Array.isArray(e)?()=>e.forEach($):e),s}add(e,s=this.genUID()){const a=e();return a?this.addDisposer(a,s):s}addEventListener(e,s,a,o,u=this.genUID()){return e.addEventListener(s,a,o),this.addDisposer(()=>e.removeEventListener(s,a,o),u),u}setTimeout(e,s,a=this.genUID()){const o=window.setTimeout(()=>{this.remove(a),e()},s);return this.addDisposer(()=>window.clearTimeout(o),a)}setInterval(e,s,a=this.genUID()){const o=window.setInterval(e,s);return this.addDisposer(()=>window.clearInterval(o),a)}remove(e){const s=this.disposers.get(e);return this.disposers.delete(e),s}flush(e){const s=this.remove(e);if(s)try{s()}catch(a){console.error(a)}}flushAll(){this.disposers.forEach($),this.disposers.clear()}genUID(){let e;do e=Q();while(this.disposers.has(e));return e}}var Z=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},x={exports:{}};(function(h,e){(function(s,a){{var o=a();h&&h.exports&&(e=h.exports=o),e.randomColor=o}})(Z,function(){var s=null,a={};K();var o=[],u=function(t){if(t=t||{},t.seed!==void 0&&t.seed!==null&&t.seed===parseInt(t.seed,10))s=t.seed;else if(typeof t.seed=="string")s=q(t.seed);else{if(t.seed!==void 0&&t.seed!==null)throw new TypeError("The seed value must be an integer or string");s=null}var n,r,i;if(t.count!==null&&t.count!==void 0){for(var l=t.count,f=[],p=0;p<t.count;p++)o.push(!1);for(t.count=null;l>f.length;){var M=u(t);s!==null&&(t.seed=s),f.push(M)}return t.count=l,f}return n=c(t),r=g(n,t),i=_(n,r,t),b([n,r,i],t)};function c(t){if(o.length>0){var n=z(t.hue),r=I(n),i=(n[1]-n[0])/o.length,l=parseInt((r-n[0])/i);o[l]===!0?l=(l+2)%o.length:o[l]=!0;var f=(n[0]+l*i)%359,p=(n[0]+(l+1)*i)%359;return n=[f,p],r=I(n),r<0&&(r=360+r),r}else{var n=B(t.hue);return r=I(n),r<0&&(r=360+r),r}}function g(t,n){if(n.hue==="monochrome")return 0;if(n.luminosity==="random")return I([0,100]);var r=F(t),i=r[0],l=r[1];switch(n.luminosity){case"bright":i=55;break;case"dark":i=l-10;break;case"light":l=55;break}return I([i,l])}function _(t,n,r){var i=y(t,n),l=100;switch(r.luminosity){case"dark":l=i+20;break;case"light":i=(l+i)/2;break;case"random":i=0,l=100;break}return I([i,l])}function b(t,n){switch(n.format){case"hsvArray":return t;case"hslArray":return N(t);case"hsl":var r=N(t);return"hsl("+r[0]+", "+r[1]+"%, "+r[2]+"%)";case"hsla":var i=N(t),p=n.alpha||Math.random();return"hsla("+i[0]+", "+i[1]+"%, "+i[2]+"%, "+p+")";case"rgbArray":return P(t);case"rgb":var l=P(t);return"rgb("+l.join(", ")+")";case"rgba":var f=P(t),p=n.alpha||Math.random();return"rgba("+f.join(", ")+", "+p+")";default:return O(t)}}function y(t,n){for(var r=D(t).lowerBounds,i=0;i<r.length-1;i++){var l=r[i][0],f=r[i][1],p=r[i+1][0],M=r[i+1][1];if(n>=l&&n<=p){var A=(M-f)/(p-l),w=f-A*l;return A*n+w}}return 0}function B(t){if(typeof parseInt(t)=="number"){var n=parseInt(t);if(n<360&&n>0)return[n,n]}if(typeof t=="string"){if(a[t]){var r=a[t];if(r.hueRange)return r.hueRange}else if(t.match(/^#?([0-9A-F]{3}|[0-9A-F]{6})$/i)){var i=V(t)[0];return[i,i]}}return[0,360]}function F(t){return D(t).saturationRange}function D(t){t>=334&&t<=360&&(t-=360);for(var n in a){var r=a[n];if(r.hueRange&&t>=r.hueRange[0]&&t<=r.hueRange[1])return a[n]}return"Color not found"}function I(t){if(s===null){var n=.618033988749895,r=Math.random();return r+=n,r%=1,Math.floor(t[0]+r*(t[1]+1-t[0]))}else{var i=t[1]||1,l=t[0]||0;s=(s*9301+49297)%233280;var f=s/233280;return Math.floor(l+f*(i-l))}}function O(t){var n=P(t);function r(l){var f=l.toString(16);return f.length==1?"0"+f:f}var i="#"+r(n[0])+r(n[1])+r(n[2]);return i}function S(t,n,r){var i=r[0][0],l=r[r.length-1][0],f=r[r.length-1][1],p=r[0][1];a[t]={hueRange:n,lowerBounds:r,saturationRange:[i,l],brightnessRange:[f,p]}}function K(){S("monochrome",null,[[0,0],[100,0]]),S("red",[-26,18],[[20,100],[30,92],[40,89],[50,85],[60,78],[70,70],[80,60],[90,55],[100,50]]),S("orange",[18,46],[[20,100],[30,93],[40,88],[50,86],[60,85],[70,70],[100,70]]),S("yellow",[46,62],[[25,100],[40,94],[50,89],[60,86],[70,84],[80,82],[90,80],[100,75]]),S("green",[62,178],[[30,100],[40,90],[50,85],[60,81],[70,74],[80,64],[90,50],[100,40]]),S("blue",[178,257],[[20,100],[30,86],[40,80],[50,74],[60,60],[70,52],[80,44],[90,39],[100,35]]),S("purple",[257,282],[[20,100],[30,87],[40,79],[50,70],[60,65],[70,59],[80,52],[90,45],[100,42]]),S("pink",[282,334],[[20,100],[30,90],[40,86],[60,84],[80,80],[90,75],[100,73]])}function P(t){var n=t[0];n===0&&(n=1),n===360&&(n=359),n=n/360;var r=t[1]/100,i=t[2]/100,l=Math.floor(n*6),f=n*6-l,p=i*(1-r),M=i*(1-f*r),A=i*(1-(1-f)*r),w=256,k=256,E=256;switch(l){case 0:w=i,k=A,E=p;break;case 1:w=M,k=i,E=p;break;case 2:w=p,k=i,E=A;break;case 3:w=p,k=M,E=i;break;case 4:w=A,k=p,E=i;break;case 5:w=i,k=p,E=M;break}var G=[Math.floor(w*255),Math.floor(k*255),Math.floor(E*255)];return G}function V(t){t=t.replace(/^#/,""),t=t.length===3?t.replace(/(.)/g,"$1$1"):t;var n=parseInt(t.substr(0,2),16)/255,r=parseInt(t.substr(2,2),16)/255,i=parseInt(t.substr(4,2),16)/255,l=Math.max(n,r,i),f=l-Math.min(n,r,i),p=l?f/l:0;switch(l){case n:return[60*((r-i)/f%6)||0,p,l];case r:return[60*((i-n)/f+2)||0,p,l];case i:return[60*((n-r)/f+4)||0,p,l]}}function N(t){var n=t[0],r=t[1]/100,i=t[2]/100,l=(2-r)*i;return[n,Math.round(r*i/(l<1?l:2-l)*1e4)/100,l/2*100]}function q(t){for(var n=0,r=0;r!==t.length&&!(n>=Number.MAX_SAFE_INTEGER);r++)n+=t.charCodeAt(r);return n}function z(t){if(isNaN(t)){if(typeof t=="string"){if(a[t]){var n=a[t];if(n.hueRange)return n.hueRange}else if(t.match(/^#?([0-9A-F]{3}|[0-9A-F]{6})$/i)){var r=V(t)[0];return D(r).hueRange}}}else{var i=parseInt(t);if(i<360&&i>0)return D(t).hueRange}return[0,360]}return u})})(x,x.exports);const ee=x.exports;class te{constructor(e="NetlessApp",s="error"){d(this,"kind"),d(this,"debug"),d(this,"color",ee({luminosity:"dark"})),this.kind=e,this.debug=s}log(...e){if(this.debug===!0||this.debug==="log")return this._log("log",e)}warn(...e){if(this.debug&&this.debug!=="error")return this._log("warn",e)}error(...e){if(this.debug)return this._log("error",e)}_log(e,s){console[e](`%c[${this.kind}]:`,`color: ${this.color}; font-weight: bold;`,...s)}}class C{constructor(){d(this,"listeners",new Set)}get length(){return this.listeners.size}dispatch(e){this.listeners.forEach(s=>s(e))}addListener(e){this.listeners.add(e)}removeListener(e){this.listeners.delete(e)}}const T=(h,e)=>Object.prototype.hasOwnProperty.call(h,e),L=Object.keys;function v(h){return typeof h=="object"&&h!==null}const se=v;function j(h){return Boolean(v(h)&&h.__isRef)}function re(h){return{k:ae(),v:h,__isRef:!0}}function ae(){return Date.now().toString().slice(6)+Math.random().toString().slice(2,8)}class ne{constructor({id:e,state:s,onSetState:a,getIsWritable:o,logger:u=console}){d(this,"id"),d(this,"getIsWritable"),d(this,"_state"),d(this,"_onSetState"),d(this,"_logger"),d(this,"onStateChanged",new C),d(this,"_destroyed",!1),d(this,"onDestroyed",new C),d(this,"_kMap",new WeakMap),d(this,"_lastValue",new Map),this.id=e,this._onSetState=a,this.getIsWritable=o,this._logger=u,this._state={},s&&L(s).forEach(c=>{const g=s[c];if(j(g)){const{k:_,v:b}=g;this._state[c]=b,v(b)&&this._kMap.set(b,_)}else this._state[c]=g})}get state(){return this._state}ensureState(e){return this.setState(L(e).reduce((s,a)=>(T(this._state,a)||(s[a]=e[a]),s),{}))}setState(e){if(this._destroyed){this._logger.error(`Cannot call setState on Store ${this.id} which is destroyed.`);return}if(!this.getIsWritable()){this._logger.error(`Cannot setState on store ${this.id} without writable access`,e);return}const s=L(e);if(s.length>0){const a={};s.forEach(o=>{const u=e[o];if(u===void 0)this._lastValue.set(o,this._state[o]),delete this._state[o],a[o]=u;else if(u!==this._state[o])if(this._lastValue.set(o,this._state[o]),this._state[o]=u,v(u)){const c=re(u);this._kMap.set(c.v,c.k),a[o]=c}else a[o]=u}),Object.keys(a).length>0&&this._onSetState(a)}}get destroyed(){return this._destroyed}_destroy(){this._destroyed=!0,this.onDestroyed.dispatch()}_updateProperties(e){if(this._destroyed){this._logger.error(`Cannot call _updateProperties on Store ${this.id} which is destroyed.`);return}if(e.length>0){const s={};e.forEach(({key:a,value:o,kind:u})=>{let c;switch(this._lastValue.has(a)&&(c=this._lastValue.get(a),this._lastValue.delete(a)),u){case 2:{T(this._state,a)&&(c=this._state[a],delete this._state[a]),s[a]={oldValue:c};break}default:{let g=o;if(j(o)){const{k:_,v:b}=o,y=this._state[a];v(y)&&this._kMap.get(y)===_?g=y:(g=b,v(b)&&this._kMap.set(b,_))}g!==this._state[a]&&(c=this._state[a],this._state[a]=g),s[a]={newValue:g,oldValue:c};break}}}),this.onStateChanged.dispatch(s)}}}class ie{constructor(e,s,a,o,u,c){d(this,"appId"),d(this,"debug"),d(this,"_logger"),d(this,"_postMessage"),d(this,"_meta"),d(this,"onRoomMembersChanged",new C),d(this,"_roomMembers"),d(this,"onMessage",new C),d(this,"onWritableChanged",new C),d(this,"_writable"),d(this,"onPageChanged",new C),d(this,"_page"),d(this,"_storeRawData"),d(this,"_stores",new Map),d(this,"_mainStoreId"),d(this,"_mainStore"),d(this,"onStateChanged"),d(this,"_sideEffect",new Y),this.appId=e.appId,this.debug=a,this._postMessage=o,this._mainStoreId=e.mainStoreId,this._storeRawData=e.store||{[this._mainStoreId]:{}},this._writable=e.writable,this._page=e.page,this._meta=e.meta,this._roomMembers=e.roomMembers,this._logger=c,this._sideEffect.add(()=>u(g=>{const{NEAType:_,payload:b}=g;if(_){const y=`_handleMsg${_}`;this[y]&&this[y](b)}})),this._mainStore=this.connectStore(e.mainStoreId,s),this.onStateChanged=this._mainStore.onStateChanged}get meta(){return this._meta}get roomMembers(){return this._roomMembers}_handleMsgRoomMembersChanged(e){if(e==null||Array.isArray(e)){const s=this._roomMembers;this._roomMembers=e,this.onRoomMembersChanged.dispatch({newValue:this._roomMembers,oldValue:s})}}moveCamera(e){this._postMessage({NEAType:"MoveCamera",payload:e})}sendMessage(e){this._postMessage({NEAType:"SendMagixMessage",payload:e})}_handleMsgReceiveMagixMessage(e){this.onMessage.dispatch(e)}get isWritable(){return this._writable}_handleMsgWritableChanged(e){const s=Boolean(e),a=this._writable;s!==a&&(this._writable=s,this.onWritableChanged.dispatch({oldValue:a,newValue:s}))}get page(){return this._page}setPage(e){this._page=e,this._postMessage({NEAType:"SetPage",payload:e})}_handleMsgPageChanged(e){se(e)&&(this._page=e.newValue,this.onPageChanged.dispatch(e))}connectStore(e,s){let a=this._stores.get(e);if(!a){if(!T(this._storeRawData,e)){const o={};this._postMessage({NEAType:"SetStore",payload:{[e]:o}}),this._storeRawData[e]=o}a=new ne({id:e,state:this._storeRawData[e],logger:this._logger,getIsWritable:()=>this._writable,onSetState:o=>this._postMessage({NEAType:"SetState",payload:{storeId:e,state:o}})}),this._stores.set(e,a)}return s&&a.ensureState(s),a}isStoreConnected(e){return this._stores.has(e)}removeStore(e){if(e===this._mainStoreId){this._logger.error(`Store "${e}" is not removable.`);return}const s=this._stores.get(e);s&&(this._stores.delete(e),s._destroy()),this._storeRawData[e]&&this._postMessage({NEAType:"SetStore",payload:{[e]:void 0}})}_handleMsgStoreChanged(e){Array.isArray(e)&&e.length>0&&e.forEach(({key:s,value:a,kind:o})=>{switch(o){case 2:{delete this._storeRawData[s];const u=this._stores.get(s);u&&(this._stores.delete(s),u._destroy());break}default:{this._storeRawData[s]=a;break}}})}get state(){return this._mainStore.state}ensureState(e){return this._mainStore.ensureState(e)}setState(e){return this._mainStore.setState(e)}_handleMsgStateChanged(e){if(v(e)&&e.storeId&&Array.isArray(e.actions)&&e.actions.length>0){const{storeId:s,actions:a}=e;a.forEach(({key:u,value:c,kind:g})=>{switch(g){case 2:{const _=this._storeRawData[s];v(_)&&delete _[u];break}default:{const _=this._storeRawData[s];v(_)&&(_[u]=c);break}}});const o=this._stores.get(s);o&&o._updateProperties(a)}}destroy(){this._sideEffect.flushAll()}}let R;function oe(h={}){if(!parent)throw new Error("[EmbeddedPageSDK]: SDK is not running in a iframe.");if(R)return Promise.resolve(R);const e=new te("EmbeddedPageSDK",h.debug),s=h.postMessage||(o=>{e.log("Message to parent",o),parent.postMessage(o,"*")}),a=h.addMessageListener||((o,u)=>{const c=({data:g,source:_})=>{!parent||_!==parent||!v(g)||!g.NEAType||(e.log("Message from parent",g),o(g))};return window.addEventListener("message",c,u),()=>{window.removeEventListener("message",c,u)}});return s({NEAType:"Init"}),new Promise(o=>{const u=a(c=>{if(R){u(),o(R);return}if(c.NEAType==="Init"){u();const g=new ie(c.payload,h.ensureState||{},Boolean(T(h,"debug")?h.debug:c.payload||!1),s,a,e);R=g,o(g)}})})}const m=h=>document.querySelector(h);async function he(){const h=await oe({ensureState:{count:0}}),e=()=>{console.log("refreshCount"),m("#count").textContent=String(h.state.count)};h.onStateChanged.addListener(e),m("#count").addEventListener("click",u=>{const c=u.shiftKey?h.state.count-1:h.state.count+1;h.setState({count:c})}),m("#message-send").addEventListener("click",()=>{const{value:u}=m("#message-payload");m("#message-recv").value+="> "+u+`
`,h.sendMessage(u)});const s=u=>{console.log("receiveMessage"),m("#message-recv").value+="< "+u+`
`};h.onMessage.addListener(s),m("#page-set").addEventListener("click",()=>{h.setPage(m("#page").value)});const a=()=>{console.log("refreshPage"),m("#page").value=String(h.page)};h.onPageChanged.addListener(a);const o=()=>{m("#writable").textContent=String(h.isWritable)};h.onWritableChanged.addListener(o),e(),a(),o(),m("#camera-move").addEventListener("click",()=>{const u=m("#camera-x").valueAsNumber,c=m("#camera-y").valueAsNumber,g={};u&&(g.x=u),c&&(g.y=c),h.moveCamera(g)}),window.embeddedApp=h}he();
