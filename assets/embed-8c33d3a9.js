import"./modulepreload-polyfill-ec808ebb.js";var G=Object.defineProperty,X=(i,e,s)=>e in i?G(i,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):i[e]=s,d=(i,e,s)=>(X(i,typeof e!="symbol"?e+"":e,s),s);const H="!#%()*+,-./:;=?@[]^_`{|}~ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",W=[],J=()=>{for(let i=0;i<20;i++)W[i]=H.charAt(Math.random()*87);return W.join("")};function j(i){try{return i()}catch(e){console.error(e)}}class Q{constructor(){this.push=this.addDisposer,this.disposers=new Map}addDisposer(e,s=this.genUID()){return this.flush(s),this.disposers.set(s,Array.isArray(e)?Y(e):e),s}add(e,s=this.genUID()){const n=e();return n?this.addDisposer(n,s):s}addEventListener(e,s,n,h,u=this.genUID()){return e.addEventListener(s,n,h),this.addDisposer(()=>e.removeEventListener(s,n,h),u),u}setTimeout(e,s,n=this.genUID()){const h=window.setTimeout(()=>{this.remove(n),e()},s);return this.addDisposer(()=>window.clearTimeout(h),n)}setInterval(e,s,n=this.genUID()){const h=window.setInterval(e,s);return this.addDisposer(()=>window.clearInterval(h),n)}remove(e){const s=this.disposers.get(e);return this.disposers.delete(e),s}flush(e){const s=this.remove(e);s&&s()}flushAll(){this.disposers.forEach(j),this.disposers.clear()}genUID(){let e;do e=J();while(this.disposers.has(e));return e}}function Y(i){return()=>i.forEach(j)}var Z=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},T={},ee={get exports(){return T},set exports(i){T=i}};(function(i,e){(function(s,n){{var h=n();i&&i.exports&&(e=i.exports=h),e.randomColor=h}})(Z,function(){var s=null,n={};O();var h=[],u=function(t){if(t=t||{},t.seed!==void 0&&t.seed!==null&&t.seed===parseInt(t.seed,10))s=t.seed;else if(typeof t.seed=="string")s=K(t.seed);else{if(t.seed!==void 0&&t.seed!==null)throw new TypeError("The seed value must be an integer or string");s=null}var a,r,o;if(t.count!==null&&t.count!==void 0){for(var l=t.count,f=[],p=0;p<t.count;p++)h.push(!1);for(t.count=null;l>f.length;){var M=u(t);s!==null&&(t.seed=s),f.push(M)}return t.count=l,f}return a=c(t),r=g(a,t),o=_(a,r,t),b([a,r,o],t)};function c(t){if(h.length>0){var a=q(t.hue),r=I(a),o=(a[1]-a[0])/h.length,l=parseInt((r-a[0])/o);h[l]===!0?l=(l+2)%h.length:h[l]=!0;var f=(a[0]+l*o)%359,p=(a[0]+(l+1)*o)%359;return a=[f,p],r=I(a),r<0&&(r=360+r),r}else{var a=U(t.hue);return r=I(a),r<0&&(r=360+r),r}}function g(t,a){if(a.hue==="monochrome")return 0;if(a.luminosity==="random")return I([0,100]);var r=B(t),o=r[0],l=r[1];switch(a.luminosity){case"bright":o=55;break;case"dark":o=l-10;break;case"light":l=55;break}return I([o,l])}function _(t,a,r){var o=y(t,a),l=100;switch(r.luminosity){case"dark":l=o+20;break;case"light":o=(l+o)/2;break;case"random":o=0,l=100;break}return I([o,l])}function b(t,a){switch(a.format){case"hsvArray":return t;case"hslArray":return L(t);case"hsl":var r=L(t);return"hsl("+r[0]+", "+r[1]+"%, "+r[2]+"%)";case"hsla":var o=L(t),p=a.alpha||Math.random();return"hsla("+o[0]+", "+o[1]+"%, "+o[2]+"%, "+p+")";case"rgbArray":return P(t);case"rgb":var l=P(t);return"rgb("+l.join(", ")+")";case"rgba":var f=P(t),p=a.alpha||Math.random();return"rgba("+f.join(", ")+", "+p+")";default:return F(t)}}function y(t,a){for(var r=D(t).lowerBounds,o=0;o<r.length-1;o++){var l=r[o][0],f=r[o][1],p=r[o+1][0],M=r[o+1][1];if(a>=l&&a<=p){var A=(M-f)/(p-l),w=f-A*l;return A*a+w}}return 0}function U(t){if(typeof parseInt(t)=="number"){var a=parseInt(t);if(a<360&&a>0)return[a,a]}if(typeof t=="string"){if(n[t]){var r=n[t];if(r.hueRange)return r.hueRange}else if(t.match(/^#?([0-9A-F]{3}|[0-9A-F]{6})$/i)){var o=x(t)[0];return[o,o]}}return[0,360]}function B(t){return D(t).saturationRange}function D(t){t>=334&&t<=360&&(t-=360);for(var a in n){var r=n[a];if(r.hueRange&&t>=r.hueRange[0]&&t<=r.hueRange[1])return n[a]}return"Color not found"}function I(t){if(s===null){var a=.618033988749895,r=Math.random();return r+=a,r%=1,Math.floor(t[0]+r*(t[1]+1-t[0]))}else{var o=t[1]||1,l=t[0]||0;s=(s*9301+49297)%233280;var f=s/233280;return Math.floor(l+f*(o-l))}}function F(t){var a=P(t);function r(l){var f=l.toString(16);return f.length==1?"0"+f:f}var o="#"+r(a[0])+r(a[1])+r(a[2]);return o}function S(t,a,r){var o=r[0][0],l=r[r.length-1][0],f=r[r.length-1][1],p=r[0][1];n[t]={hueRange:a,lowerBounds:r,saturationRange:[o,l],brightnessRange:[f,p]}}function O(){S("monochrome",null,[[0,0],[100,0]]),S("red",[-26,18],[[20,100],[30,92],[40,89],[50,85],[60,78],[70,70],[80,60],[90,55],[100,50]]),S("orange",[18,46],[[20,100],[30,93],[40,88],[50,86],[60,85],[70,70],[100,70]]),S("yellow",[46,62],[[25,100],[40,94],[50,89],[60,86],[70,84],[80,82],[90,80],[100,75]]),S("green",[62,178],[[30,100],[40,90],[50,85],[60,81],[70,74],[80,64],[90,50],[100,40]]),S("blue",[178,257],[[20,100],[30,86],[40,80],[50,74],[60,60],[70,52],[80,44],[90,39],[100,35]]),S("purple",[257,282],[[20,100],[30,87],[40,79],[50,70],[60,65],[70,59],[80,52],[90,45],[100,42]]),S("pink",[282,334],[[20,100],[30,90],[40,86],[60,84],[80,80],[90,75],[100,73]])}function P(t){var a=t[0];a===0&&(a=1),a===360&&(a=359),a=a/360;var r=t[1]/100,o=t[2]/100,l=Math.floor(a*6),f=a*6-l,p=o*(1-r),M=o*(1-f*r),A=o*(1-(1-f)*r),w=256,k=256,E=256;switch(l){case 0:w=o,k=A,E=p;break;case 1:w=M,k=o,E=p;break;case 2:w=p,k=o,E=A;break;case 3:w=p,k=M,E=o;break;case 4:w=A,k=p,E=o;break;case 5:w=o,k=p,E=M;break}var z=[Math.floor(w*255),Math.floor(k*255),Math.floor(E*255)];return z}function x(t){t=t.replace(/^#/,""),t=t.length===3?t.replace(/(.)/g,"$1$1"):t;var a=parseInt(t.substr(0,2),16)/255,r=parseInt(t.substr(2,2),16)/255,o=parseInt(t.substr(4,2),16)/255,l=Math.max(a,r,o),f=l-Math.min(a,r,o),p=l?f/l:0;switch(l){case a:return[60*((r-o)/f%6)||0,p,l];case r:return[60*((o-a)/f+2)||0,p,l];case o:return[60*((a-r)/f+4)||0,p,l]}}function L(t){var a=t[0],r=t[1]/100,o=t[2]/100,l=(2-r)*o;return[a,Math.round(r*o/(l<1?l:2-l)*1e4)/100,l/2*100]}function K(t){for(var a=0,r=0;r!==t.length&&!(a>=Number.MAX_SAFE_INTEGER);r++)a+=t.charCodeAt(r);return a}function q(t){if(isNaN(t)){if(typeof t=="string"){if(n[t]){var a=n[t];if(a.hueRange)return a.hueRange}else if(t.match(/^#?([0-9A-F]{3}|[0-9A-F]{6})$/i)){var r=x(t)[0];return D(r).hueRange}}}else{var o=parseInt(t);if(o<360&&o>0)return D(t).hueRange}return[0,360]}return u})})(ee,T);class te{constructor(e="NetlessApp",s="error"){d(this,"kind"),d(this,"debug"),d(this,"color",T({luminosity:"dark"})),this.kind=e,this.debug=s}log(...e){if(this.debug===!0||this.debug==="log")return this._log("log",e)}warn(...e){if(this.debug&&this.debug!=="error")return this._log("warn",e)}error(...e){if(this.debug)return this._log("error",e)}_log(e,s){console[e](`%c[${this.kind}]:`,`color: ${this.color}; font-weight: bold;`,...s)}}class C{constructor(){d(this,"listeners",new Set)}get length(){return this.listeners.size}dispatch(e){this.listeners.forEach(s=>s(e))}addListener(e){this.listeners.add(e)}removeListener(e){this.listeners.delete(e)}}const N=(i,e)=>Object.prototype.hasOwnProperty.call(i,e),V=Object.keys;function v(i){return typeof i=="object"&&i!==null}const se=v;function $(i){return Boolean(v(i)&&i.__isRef)}function re(i){return{k:ae(),v:i,__isRef:!0}}function ae(){return Date.now().toString().slice(6)+Math.random().toString().slice(2,8)}class ne{constructor({id:e,state:s,onSetState:n,getIsWritable:h,logger:u=console}){d(this,"id"),d(this,"getIsWritable"),d(this,"_state"),d(this,"_onSetState"),d(this,"_logger"),d(this,"onStateChanged",new C),d(this,"_destroyed",!1),d(this,"onDestroyed",new C),d(this,"_kMap",new WeakMap),d(this,"_lastValue",new Map),this.id=e,this._onSetState=n,this.getIsWritable=h,this._logger=u,this._state={},s&&V(s).forEach(c=>{const g=s[c];if($(g)){const{k:_,v:b}=g;this._state[c]=b,v(b)&&this._kMap.set(b,_)}else this._state[c]=g})}get state(){return this._state}ensureState(e){return this.setState(V(e).reduce((s,n)=>(N(this._state,n)||(s[n]=e[n]),s),{}))}setState(e){if(this._destroyed){this._logger.error(`Cannot call setState on Store ${this.id} which is destroyed.`);return}if(!this.getIsWritable()){this._logger.error(`Cannot setState on store ${this.id} without writable access`,e);return}const s=V(e);if(s.length>0){const n={};s.forEach(h=>{const u=e[h];if(u===void 0)this._lastValue.set(h,this._state[h]),delete this._state[h],n[h]=u;else if(u!==this._state[h])if(this._lastValue.set(h,this._state[h]),this._state[h]=u,v(u)){const c=re(u);this._kMap.set(c.v,c.k),n[h]=c}else n[h]=u}),Object.keys(n).length>0&&this._onSetState(n)}}get destroyed(){return this._destroyed}_destroy(){this._destroyed=!0,this.onDestroyed.dispatch()}_updateProperties(e){if(this._destroyed){this._logger.error(`Cannot call _updateProperties on Store ${this.id} which is destroyed.`);return}if(e.length>0){const s={};e.forEach(({key:n,value:h,kind:u})=>{let c;switch(this._lastValue.has(n)&&(c=this._lastValue.get(n),this._lastValue.delete(n)),u){case 2:{N(this._state,n)&&(c=this._state[n],delete this._state[n]),s[n]={oldValue:c};break}default:{let g=h;if($(h)){const{k:_,v:b}=h,y=this._state[n];v(y)&&this._kMap.get(y)===_?g=y:(g=b,v(b)&&this._kMap.set(b,_))}g!==this._state[n]&&(c=this._state[n],this._state[n]=g),s[n]={newValue:g,oldValue:c};break}}}),this.onStateChanged.dispatch(s)}}}class ie{constructor(e,s,n,h,u,c){d(this,"appId"),d(this,"debug"),d(this,"_logger"),d(this,"_postMessage"),d(this,"_meta"),d(this,"onRoomMembersChanged",new C),d(this,"_roomMembers"),d(this,"onMessage",new C),d(this,"onWritableChanged",new C),d(this,"_writable"),d(this,"onPageChanged",new C),d(this,"_page"),d(this,"_storeRawData"),d(this,"_stores",new Map),d(this,"_mainStoreId"),d(this,"_mainStore"),d(this,"onStateChanged"),d(this,"_sideEffect",new Q),this.appId=e.appId,this.debug=n,this._postMessage=h,this._mainStoreId=e.mainStoreId,this._storeRawData=e.store||{[this._mainStoreId]:{}},this._writable=e.writable,this._page=e.page,this._meta=e.meta,this._roomMembers=e.roomMembers,this._logger=c,this._sideEffect.add(()=>u(g=>{const{NEAType:_,payload:b}=g;if(_){const y=`_handleMsg${_}`;this[y]&&this[y](b)}})),this._mainStore=this.connectStore(e.mainStoreId,s),this.onStateChanged=this._mainStore.onStateChanged}get meta(){return this._meta}get roomMembers(){return this._roomMembers}_handleMsgRoomMembersChanged(e){if(e==null||Array.isArray(e)){const s=this._roomMembers;this._roomMembers=e,this.onRoomMembersChanged.dispatch({newValue:this._roomMembers,oldValue:s})}}moveCamera(e){this._postMessage({NEAType:"MoveCamera",payload:e})}sendMessage(e){this._postMessage({NEAType:"SendMagixMessage",payload:e})}_handleMsgReceiveMagixMessage(e){this.onMessage.dispatch(e)}get isWritable(){return this._writable}_handleMsgWritableChanged(e){const s=Boolean(e),n=this._writable;s!==n&&(this._writable=s,this.onWritableChanged.dispatch({oldValue:n,newValue:s}))}get page(){return this._page}setPage(e){this._page=e,this._postMessage({NEAType:"SetPage",payload:e})}_handleMsgPageChanged(e){se(e)&&(this._page=e.newValue,this.onPageChanged.dispatch(e))}connectStore(e,s){let n=this._stores.get(e);if(!n){if(!N(this._storeRawData,e)){const h={};this._postMessage({NEAType:"SetStore",payload:{[e]:h}}),this._storeRawData[e]=h}n=new ne({id:e,state:this._storeRawData[e],logger:this._logger,getIsWritable:()=>this._writable,onSetState:h=>this._postMessage({NEAType:"SetState",payload:{storeId:e,state:h}})}),this._stores.set(e,n)}return s&&n.ensureState(s),n}isStoreConnected(e){return this._stores.has(e)}removeStore(e){if(e===this._mainStoreId){this._logger.error(`Store "${e}" is not removable.`);return}const s=this._stores.get(e);s&&(this._stores.delete(e),s._destroy()),this._storeRawData[e]&&this._postMessage({NEAType:"SetStore",payload:{[e]:void 0}})}_handleMsgStoreChanged(e){Array.isArray(e)&&e.length>0&&e.forEach(({key:s,value:n,kind:h})=>{switch(h){case 2:{delete this._storeRawData[s];const u=this._stores.get(s);u&&(this._stores.delete(s),u._destroy());break}default:{this._storeRawData[s]=n;break}}})}get state(){return this._mainStore.state}ensureState(e){return this._mainStore.ensureState(e)}setState(e){return this._mainStore.setState(e)}_handleMsgStateChanged(e){if(v(e)&&e.storeId&&Array.isArray(e.actions)&&e.actions.length>0){const{storeId:s,actions:n}=e;n.forEach(({key:u,value:c,kind:g})=>{switch(g){case 2:{const _=this._storeRawData[s];v(_)&&delete _[u];break}default:{const _=this._storeRawData[s];v(_)&&(_[u]=c);break}}});const h=this._stores.get(s);h&&h._updateProperties(n)}}destroy(){this._sideEffect.flushAll()}}let R;function oe(i={}){if(!parent)throw new Error("[EmbeddedPageSDK]: SDK is not running in a iframe.");if(R)return Promise.resolve(R);const e=new te("EmbeddedPageSDK",i.debug),s=i.postMessage||(h=>{e.log("Message to parent",h),parent.postMessage(h,"*")}),n=i.addMessageListener||((h,u)=>{const c=({data:g,source:_})=>{!parent||_!==parent||!v(g)||!g.NEAType||(e.log("Message from parent",g),h(g))};return window.addEventListener("message",c,u),()=>{window.removeEventListener("message",c,u)}});return s({NEAType:"Init"}),new Promise(h=>{const u=n(c=>{if(R){u(),h(R);return}if(c.NEAType==="Init"){u();const g=new ie(c.payload,i.ensureState||{},Boolean(N(i,"debug")?i.debug:c.payload||!1),s,n,e);R=g,h(g)}})})}const m=i=>document.querySelector(i);async function he(){const i=await oe({ensureState:{count:0}}),e=()=>{console.log("refreshCount"),m("#count").textContent=String(i.state.count)};i.onStateChanged.addListener(e),m("#count").addEventListener("click",u=>{const c=u.shiftKey?i.state.count-1:i.state.count+1;i.setState({count:c})}),m("#message-send").addEventListener("click",()=>{const{value:u}=m("#message-payload");m("#message-recv").value+="> "+u+`
`,i.sendMessage(u)});const s=u=>{console.log("receiveMessage"),m("#message-recv").value+="< "+u+`
`};i.onMessage.addListener(s),m("#page-set").addEventListener("click",()=>{i.setPage(m("#page").value)});const n=()=>{console.log("refreshPage"),m("#page").value=String(i.page)};i.onPageChanged.addListener(n);const h=()=>{m("#writable").textContent=String(i.isWritable)};i.onWritableChanged.addListener(h),e(),n(),h(),m("#camera-move").addEventListener("click",()=>{const u=m("#camera-x").valueAsNumber,c=m("#camera-y").valueAsNumber,g={};u&&(g.x=u),c&&(g.y=c),i.moveCamera(g)}),window.embeddedApp=i}he();
