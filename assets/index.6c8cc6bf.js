import{o as I,p as m,y,v as t,_ as P,A as S,q as X,u as U}from"./index.dc7b70a6.js";import{c as z}from"./index.dc048eb9.js";import"./modulepreload-polyfill.c7c6310f.js";const _=`.time-cell{display:flex;flex-flow:column nowrap;align-items:center;font-family:sans-serif;font-weight:700}.time-cell.disabled .time-cell-up:before,.time-cell.disabled .time-cell-down:after{border-top-color:#0000000d;border-bottom-color:#0000000d}.time-cell-up:before,.time-cell-down:after{content:"";display:block;width:0;height:0;margin:0 0 4px;border-top:0;border-left:12px solid transparent;border-right:12px solid transparent;border-bottom:12px solid #151515;transition:border-color .4s;cursor:pointer}.time-cell-down:after{margin:4px 0 0;border-top:12px solid #151515;border-bottom:0}.rotor{position:relative;width:36px;height:64px;border-radius:4px;font-size:48px;text-align:center;perspective:200px}.rotor-top,.rotor-bottom{overflow:hidden;position:absolute;width:36px;height:32px}.rotor-leaf{z-index:1;position:absolute;width:36px;height:64px;transform-style:preserve-3d;transition:transform 0s}.rotor-leaf.flipped{transform:rotateX(-180deg);transition:all .5s ease-in-out}.rotor-leaf-front,.rotor-leaf-rear{overflow:hidden;position:absolute;width:36px;height:32px;margin:0;transform:rotateX(0);backface-visibility:hidden;-webkit-backface-visibility:hidden}.rotor-leaf-front{line-height:64px;border-radius:4px 4px 0 0}.rotor-leaf-rear{line-height:0px;border-radius:0 0 4px 4px;transform:rotateX(-180deg)}.rotor-top{line-height:64px;border-radius:4px 4px 0 0}.rotor-bottom{bottom:0;line-height:0px;border-radius:0 0 4px 4px}.rotor:after{content:"";z-index:2;position:absolute;bottom:0px;left:0px;width:36px;height:32px;border-radius:0 0 4px 4px}.rotor,.rotor-top,.rotor-leaf-front{color:#fff;background-color:#151515}.rotor-bottom,.rotor-leaf-rear{color:#efefef;background-color:#202020}.rotor:after{border-top:solid 1px #151515}.telebox-color-scheme-dark .time-cell.disabled .time-cell-up:before,.telebox-color-scheme-dark .time-cell.disabled .time-cell-down:after{border-top-color:#ffffff14;border-bottom-color:#ffffff14}.telebox-color-scheme-dark .time-cell-up:before,.telebox-color-scheme-dark .time-cell-down:after{border-top-color:#d9d9df;border-bottom-color:#d9d9df}.telebox-color-scheme-dark .rotor,.telebox-color-scheme-dark .rotor-top,.telebox-color-scheme-dark .rotor-leaf-front{color:#383838;background-color:#efeff5}.telebox-color-scheme-dark .rotor-bottom,.telebox-color-scheme-dark .rotor-leaf-rear{color:#333;background-color:#eeecec}.telebox-color-scheme-dark .rotor:after{border-top:solid 1px #efeff5}.countdown-clock{display:flex;padding:5px}.countdown-clock>*{padding:0 5px}.countdown-clock-divider{display:flex;flex-direction:column;justify-content:center;align-items:center;padding:0 1px}.countdown-clock-divider:before,.countdown-clock-divider:after{content:"";display:block;width:8px;height:8px;margin:6px 0;background-color:#000;border-radius:50%}.netless-app-countdown{width:100%;height:100%;display:flex;flex-direction:column;justify-content:center;align-items:center;transition:background-color .4s}.netless-app-countdown-shrink{display:inline-block;transition:background-color .4s}.netless-app-countdown-btns{width:100%;margin-top:10px;display:flex;flex-wrap:nowrap}.netless-app-countdown-btns>button{flex:1;display:block;margin:0 10px 0 0;padding:5px 10px;text-align:center;border:0;border-radius:4px;color:#fff;background-color:#3380ff;transition:background-color .4s,color .4s;cursor:pointer}.netless-app-countdown-btns>button:last-of-type{margin:0}.netless-app-countdown-btns>button:disabled{color:#00000040;background:#f5f5f5;cursor:not-allowed}.telebox-color-scheme-dark .netless-app-countdown-btns>button:disabled{color:#ffffff4d;background:rgba(255,255,255,.08)}
`;const N=I(({digit:o,disabled:e,onUp:r,onDown:n})=>{const[i,c]=m(0),[d,a]=m(!1);return y(()=>{if(e){a(!0);const l=window.setTimeout(()=>{a(!1),c(o)},500);return()=>window.clearTimeout(l)}else c(o)},[o]),t("div",{class:z("time-cell",{disabled:e})},t("div",{class:"time-cell-up",onClick:e?void 0:r}),t("div",{class:"rotor"},t("div",{class:z("rotor-leaf",{flipped:d})},t("figure",{class:"rotor-leaf-rear"},o),t("figure",{class:"rotor-leaf-front"},i)),t("div",{class:"rotor-top"},o),t("div",{class:"rotor-bottom"},i)),t("div",{class:"time-cell-down",onClick:e?void 0:n}))});var f=(o=>(o[o.AddTenMinutes=0]="AddTenMinutes",o[o.ReduceTenMinutes=1]="ReduceTenMinutes",o[o.AddOneMinute=2]="AddOneMinute",o[o.ReduceOneMinute=3]="ReduceOneMinute",o[o.AddTenSeconds=4]="AddTenSeconds",o[o.ReduceTenSeconds=5]="ReduceTenSeconds",o[o.AddOneSecond=6]="AddOneSecond",o[o.ReduceOneSecond=7]="ReduceOneSecond",o))(f||{});function H(o){return P(()=>(o=o%61,[Math.floor(o/10),o%10]),[o])}function b(o,e){return S(()=>o(e),[o])}const $=I(({minutes:o,seconds:e,disabled:r,onAdjustTime:n})=>{const i=H(o),c=H(e),d=b(n,0),a=b(n,1),l=b(n,2),s=b(n,3),g=b(n,4),h=b(n,5),w=b(n,6),k=b(n,7);return t("div",{className:"countdown-clock"},t(N,{disabled:r,digit:i[0],onUp:d,onDown:a}),t(N,{digit:i[1],disabled:r,onUp:l,onDown:s}),t("div",{class:"countdown-clock-divider"}),t(N,{disabled:r,digit:c[0],onUp:g,onDown:h}),t(N,{digit:c[1],disabled:r,onUp:w,onDown:k}))}),q=I(({readonly:o,countdownSecs:e,startTime:r,paused:n,onAdjustTime:i,onStart:c,onPause:d,onResume:a,onReset:l})=>{const[s,g]=m(0),h=r>0&&s>=r,w=e-(h?s-r:0),k=Math.floor(w/60),F=w-k*60;return y(()=>{let O=NaN;if(e>0&&r>0&&!n){const M=()=>{g(Math.floor(Date.now()/1e3)),O=window.requestAnimationFrame(M)};return M(),()=>window.cancelAnimationFrame(O)}else window.cancelAnimationFrame(O)},[r,n,e]),y(()=>{r>0&&s-r>=e&&l()},[s,r,e,l]),t("div",{class:"netless-app-countdown"},t("div",{class:"netless-app-countdown-shrink"},t($,{minutes:k,seconds:F,disabled:o||h,onAdjustTime:i}),t("div",{class:"netless-app-countdown-btns"},n?t(X,null,t("button",{onClick:l,disabled:o},"Reset"),t("button",{onClick:a,disabled:o},"Resume")):h?t("button",{onClick:d,disabled:o},"Pause"):t("button",{onClick:c,disabled:o||w<=0},"Start"))))}),E=I(({context:o,storage:e})=>{const[r,n]=m(()=>o.isWritable),[i,c]=m(e.state.countdownSecs),[d,a]=m(e.state.startTime),[l,s]=m(e.state.paused),g=d>0,h=S(()=>{o.isWritable&&(s(!1),a(Math.floor(Date.now()/1e3)))},[o]),w=S(()=>{o.isWritable&&s(!0)},[o]),k=S(()=>{o.isWritable&&s(!1)},[o]),F=S(()=>{o.isWritable&&(s(!1),c(0),a(0))},[o]),O=S(M=>{g||c(p=>{if(!o.isWritable)return p;const x=Math.floor(p/60),u=p-x*60,C=Math.floor(x/10),v=x%10,R=Math.floor(u/10),W=u%10;switch(M){case f.AddTenMinutes:{const D=v+u===0?7:6;return((C+1)%D*10+v)*60+u}case f.ReduceTenMinutes:{const D=v+u===0?7:6;return((C+D-1)%D*10+v)*60+u}case f.AddOneMinute:return(Math.min(5,C)*10+(v+1)%10)*60+u;case f.ReduceOneMinute:return(Math.min(5,C)*10+(v+10-1)%10)*60+u;case f.AddTenSeconds:return x*60+((R+1)%6*10+W);case f.ReduceTenSeconds:return x*60+((R+6-1)%6*10+W);case f.AddOneSecond:return x*60+(Math.min(5,R)*10+(W+1)%10);case f.ReduceOneSecond:return x*60+(Math.min(5,R)*10+(W+10-1)%10);default:return p}})},[g,o]);return y(()=>(n(o.isWritable),o.emitter.on("writableChange",n),()=>o.emitter.off("writableChange",n)),[o]),y(()=>{const M=p=>{p.countdownSecs&&c(e.state.countdownSecs),p.paused&&s(e.state.paused),p.startTime&&a(e.state.startTime)};return e.on("stateChanged",M)},[e]),y(()=>{o.isWritable&&e.setState({countdownSecs:i,paused:l,startTime:d})},[i,l,d,o]),t(q,{readonly:!r,countdownSecs:i,startTime:d,paused:l,onAdjustTime:O,onStart:h,onPause:w,onResume:k,onReset:F})}),G=208,B=216,Q={kind:"Countdown",config:{minwidth:G,minheight:B},setup(o){const e=o.box;e.mountStyles(_);const r=o.createStorage("state",{countdownSecs:0,startTime:0,paused:!1});U(t(E,{context:o,storage:r}),e.$content),o.emitter.on("destroy",()=>{U(null,e.$content)})}};export{Q as default};
