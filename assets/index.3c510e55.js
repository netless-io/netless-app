var J=Object.defineProperty;var q=(t,e,s)=>e in t?J(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s;var c=(t,e,s)=>(q(t,typeof e!="symbol"?e+"":e,s),s);import{ai as K,aj as Q,ak as V,R as X,al as D,am as Y}from"./index.dc7b70a6.js";import{an as Se,am as $e}from"./index.dc7b70a6.js";import"./modulepreload-polyfill.c7c6310f.js";const R="netless-app-slide",G="https://convertcdn.netless.link/dynamicConvert";function M(){}function g(t){return document.createElement(t)}function U(t,e){const s=g(t);return v(s,e),s}function I(t,e){return t.appendChild(e)}function b(t){return`${R}-${t}`}function v(t,e){t.className=b(e)}function Z(t){return t.endsWith("/")?t.slice(0,-1):t}function B(t,e){if(typeof t=="object"&&t!==null)return t[e]}function O(){let t;return[new Promise(s=>{t=s}),t]}function ee(t){const e=t.room,s=t.displayer;return e?()=>e.calibrationTimestamp:s?()=>s.beginTimestamp+s.progressTime:()=>Date.now()}function W(t){try{let e=window.getComputedStyle(t).backgroundColor;if(e!=="rgba(0, 0, 0, 0)"&&e!=="transparent")return e=te(e),console.log("[Slide] guess bg color:",e),e;if(t.parentElement)return W(t.parentElement)}catch{}return"#ffffff"}function te(t){const e=K.exports.get(t);if(e&&e.model==="rgb"){const s=e.value,a=(((Math.round(s[0])&255)<<16)+((Math.round(s[1])&255)<<8)+(Math.round(s[2])&255)).toString(16);return"#"+"000000".substring(a.length)+a}else return t}function H(t,e){return`${Z(e||G)}/${t}`}async function se({taskId:t,url:e}){const s=H(t,e),n=`${s}/preview/1.png`,a=`${s}/jsonOutput/slide-1.json`,p=new Promise(o=>{const d=new Image;d.onload=()=>o(d),d.onerror=()=>o(null),d.src=n}),r=fetch(a).then(o=>o.json());return{preview:await p,slide:await r}}function ne(t){if(typeof document<"u"){const e=()=>t(document.visibilityState==="visible");return document.addEventListener("visibilitychange",e),()=>document.removeEventListener("visibilitychange",e)}return M}const oe=`.netless-app-slide-tele-fancy-scrollbar{overscroll-behavior:contain;overflow:auto;overflow-y:scroll;overflow-y:overlay;-webkit-overflow-scrolling:touch;-ms-overflow-style:-ms-autohiding-scrollbar;scrollbar-width:auto}.netless-app-slide-tele-fancy-scrollbar::-webkit-scrollbar{height:8px;width:8px}.netless-app-slide-tele-fancy-scrollbar::-webkit-scrollbar-track{background-color:transparent}.netless-app-slide-tele-fancy-scrollbar::-webkit-scrollbar-thumb{background-color:#444e601a;background-color:transparent;border-radius:4px;transition:background-color .4s}.netless-app-slide-tele-fancy-scrollbar:hover::-webkit-scrollbar-thumb{background-color:#444e601a}.netless-app-slide-tele-fancy-scrollbar::-webkit-scrollbar-thumb:hover{background-color:#444e6033}.netless-app-slide-tele-fancy-scrollbar::-webkit-scrollbar-thumb:active{background-color:#444e6033}.netless-app-slide-tele-fancy-scrollbar::-webkit-scrollbar-thumb:vertical{min-height:50px}.netless-app-slide-tele-fancy-scrollbar::-webkit-scrollbar-thumb:horizontal{min-width:50px}.netless-app-slide-content{position:relative;height:100%;overflow:hidden}.netless-app-slide-slide{width:100%;height:100%;-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.netless-app-slide-preview-mask{display:none;position:absolute;z-index:10200;top:0;left:0;width:100%;height:100%}.netless-app-slide-preview{display:flex;flex-direction:column;align-items:center;position:absolute;z-index:10300;top:0;left:0;width:33%;max-width:200px;height:100%;padding-top:10px;transform:translate(-100%);background:rgba(237,237,240,.9);box-shadow:inset -1px 0 #0000001c;transition:transform .4s;-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.netless-app-slide-preview-active .netless-app-slide-preview-mask{display:block}.netless-app-slide-preview-active .netless-app-slide-preview{transform:translate(0)}.netless-app-slide-preview-page{position:relative;display:block;width:55%;margin-bottom:10px;font-size:0;color:transparent;outline:none;border:7px solid transparent;border-radius:4px;transition:border-color .3s;-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.netless-app-slide-preview-page:hover,.netless-app-slide-preview-page.netless-app-slide-preview-page-active{border-color:#444e601a}.netless-app-slide-preview-page>img{width:100%;height:auto;box-sizing:border-box;border:1px solid rgba(0,0,0,.5);border-radius:1px;background-color:#fff;box-shadow:0 2px 8px #0000004d}.netless-app-slide-preview-page-name{position:absolute;top:1px;left:-10px;transform:translate(-100%);text-align:right;font-size:12px;color:#5f5f5f;-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.netless-app-slide-overlay{display:flex;align-items:center;justify-content:center;position:absolute;z-index:10100;top:0;left:0;width:100%;height:100%;background:rgba(255,0,0,.25);transition:opacity .3s;opacity:0;pointer-events:none}.netless-app-slide-footer{box-sizing:border-box;height:26px;display:flex;align-items:center;padding:0 16px;border-top:1px solid #eeeef7;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,sans-serif,"Apple Color Emoji","Segoe UI Emoji",Segoe UI Symbol,"Noto Color Emoji"}.netless-app-slide-float-footer{width:100%;min-height:26px;position:absolute;left:0;bottom:0;z-index:2000;background:rgba(249,249,252,.9);transition:opacity .4s}.netless-app-slide-footer-btn{box-sizing:border-box;width:26px;height:26px;font-size:0;margin:0;padding:3px;border:none;border-radius:1px;outline:none;color:currentColor;background:transparent;transition:background .4s;cursor:pointer;-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-tap-highlight-color:rgba(0,0,0,0)}.netless-app-slide-footer-btn:hover{background:rgba(237,237,240,.9)}@media (hover: none){.netless-app-slide-footer-btn:hover{background:transparent!important}}.netless-app-slide-footer-btn>svg{width:100%;height:100%}.netless-app-slide-footer-btn>svg:nth-of-type(2){display:none}.netless-app-slide-footer-btn.netless-app-slide-footer-btn-playing>svg:nth-of-type(1){display:none}.netless-app-slide-footer-btn.netless-app-slide-footer-btn-playing>svg:nth-of-type(2){display:initial}.netless-app-slide-footer-btn~.netless-app-slide-footer-btn{margin-left:15px}.netless-app-slide-page-jumps{flex:1;display:flex;justify-content:center;align-items:center}.netless-app-slide-page-number{display:flex;align-items:center;height:26px;margin-left:auto;font-size:13px;-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;white-space:nowrap;word-break:keep-all;font-variant-numeric:tabular-nums}.netless-app-slide-page-number-input{border:none;outline:none;width:3em;margin:0;padding:0 .5em 0 2px;text-align:right;font-size:13px;line-height:1;font-weight:400;font-family:inherit;border-radius:2px;color:currentColor;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,sans-serif,"Apple Color Emoji","Segoe UI Emoji",Segoe UI Symbol,"Noto Color Emoji";background:transparent;transition:background .4s;font-variant-numeric:tabular-nums;-webkit-tap-highlight-color:rgba(0,0,0,0)}.netless-app-slide-page-number-input:hover,.netless-app-slide-page-number-input:focus,.netless-app-slide-page-number-input:active{user-select:text;background:#fff;box-shadow:#63636333 0 2px 8px}.netless-app-slide-readonly .netless-app-slide-footer-btn{cursor:not-allowed}.netless-app-slide-readonly .netless-app-slide-footer-btn:hover{background:transparent}.netless-app-slide-readonly .netless-app-slide-page-number-input{cursor:not-allowed}.netless-app-slide-readonly .netless-app-slide-page-number-input:hover,.netless-app-slide-readonly .netless-app-slide-page-number-input:focus,.netless-app-slide-readonly .netless-app-slide-page-number-input:active{background:transparent;box-shadow:none}.netless-app-slide-readonly .netless-app-slide-page-number-input:disabled{color:inherit}.netless-app-slide-readonly.netless-app-slide-float-footer{display:none}.telebox-color-scheme-dark .netless-app-slide-page-number-input:active,.telebox-color-scheme-dark .netless-app-slide-page-number-input:focus,.telebox-color-scheme-dark .netless-app-slide-page-number-input:hover{color:currentColor;background:#25282e}.telebox-color-scheme-dark .netless-app-slide-footer{border-top:none}.telebox-color-scheme-dark .netless-app-slide-footer-btn:hover{background:#212126}.telebox-color-scheme-dark .netless-app-slide-preview{background:rgba(50,50,50,.9)}.netless-app-slide-preview-wrapper{width:100%;height:100%;overflow:hidden;display:flex;flex-flow:column nowrap}.netless-app-slide-preview-wrapper .netless-app-slide-content{flex:1}.netless-app-slide-preview-wrapper .netless-app-slide-footer{flex-shrink:0}
`;function ie(t){const e="http://www.w3.org/2000/svg",s=document.createElementNS(e,"svg");s.setAttribute("class",`${t}-footer-icon-sidebar`),s.setAttribute("viewBox","0 0 64 64");const n=document.createElementNS(e,"path");return n.setAttribute("fill","currentColor"),n.setAttribute("d","M50 8H14c-3.309 0-6 2.691-6 6v36c0 3.309 2.691 6 6 6h36c3.309 0 6-2.691 6-6V14c0-3.309-2.691-6-6-6zM12 50V14c0-1.103.897-2 2-2h8v40h-8c-1.103 0-2-.897-2-2zm40 0c0 1.103-.897 2-2 2H26V12h24c1.103 0 2 .897 2 2z"),s.appendChild(n),s}function re(t){const e="http://www.w3.org/2000/svg",s=document.createElementNS(e,"svg");s.setAttribute("class",`${t}-footer-icon-arrow-left`),s.setAttribute("viewBox","0 0 500 500");const n=document.createElementNS(e,"path");return n.setAttribute("fill","currentColor"),n.setAttribute("d","M177.81 249.959L337.473 90.295c2.722-2.865 2.651-7.378-.143-10.1-2.793-2.65-7.163-2.65-9.956 0l-164.75 164.75c-2.793 2.793-2.793 7.306 0 10.1l164.75 164.75c2.865 2.722 7.378 2.65 10.099-.143 2.651-2.794 2.651-7.163 0-9.957L177.809 249.959z"),s.appendChild(n),s}function ae(t){const e="http://www.w3.org/2000/svg",s=document.createElementNS(e,"svg");s.setAttribute("class",`${t}-footer-icon-play`),s.setAttribute("viewBox","0 0 500 500");const n=document.createElementNS(e,"path");return n.setAttribute("fill","currentColor"),n.setAttribute("d","M418.158 257.419L174.663 413.33c-6.017 3.919-15.708 3.772-21.291-.29-2.791-2.018-4.295-4.483-4.295-7.084V94.109c0-5.65 6.883-10.289 15.271-10.289 4.298 0 8.391 1.307 11.181 3.332l242.629 155.484c6.016 3.917 6.451 10.292.649 14.491-.216.154-.432.154-.649.292zM170.621 391.288l223.116-141.301L170.71 107.753l-.089 283.535z"),s.appendChild(n),s}function le(t){const e="http://www.w3.org/2000/svg",s=document.createElementNS(e,"svg");s.setAttribute("class",`${t}-footer-icon-pause`),s.setAttribute("viewBox","0 0 500 500");const n=document.createElementNS(e,"path");return n.setAttribute("fill","currentColor"),n.setAttribute("d","M312.491 78.261c0-6.159 4.893-11.213 11.04-11.213 6.158 0 11.211 5.054 11.211 11.213v343.478c0 6.159-5.053 11.213-11.211 11.213-6.147 0-11.04-5.054-11.04-11.213V78.261zM165.257 78.261c0-6.159 4.893-11.213 11.04-11.213 6.158 0 11.211 5.054 11.211 11.213v343.478c0 6.159-5.053 11.213-11.211 11.213-6.147 0-11.04-5.054-11.04-11.213V78.261z"),s.appendChild(n),s}function pe(t){const e="http://www.w3.org/2000/svg",s=document.createElementNS(e,"svg");s.setAttribute("class",`${t}-footer-icon-arrow-right`),s.setAttribute("viewBox","0 0 500 500");const n=document.createElementNS(e,"path");return n.setAttribute("fill","currentColor"),n.setAttribute("d","M322.19 250.041L162.527 409.705c-2.722 2.865-2.651 7.378.143 10.1 2.793 2.65 7.163 2.65 9.956 0l164.75-164.75c2.793-2.793 2.793-7.306 0-10.1l-164.75-164.75c-2.865-2.722-7.378-2.65-10.099.143-2.651 2.794-2.651 7.163 0 9.957l159.664 159.736z"),s.appendChild(n),s}function de(){let t=M;const e=l=>{t=l};let s=M;const n=l=>{s=l};let a=M;const p=l=>{a=l};let r=!1,o=!1,d=0,h=0;const i=g("div");v(i,"footer");const u=g("button");v(u,"btn-sidebar"),u.classList.add(b("footer-btn")),u.appendChild(ie(R)),u.onclick=function(){r||s()},u.style.display="none",i.appendChild(u);const m=g("div");v(m,"page-jumps");const k=g("button");v(k,"btn-page-back"),k.classList.add(b("footer-btn")),k.appendChild(re(R)),k.onclick=function(){r||t(d-1)},m.appendChild(k);const w=g("button");v(w,"btn-page-play"),w.classList.add(b("footer-btn")),w.appendChild(ae(R)),w.appendChild(le(R));let A=0;w.onclick=function(){r||(w.classList.add(b("footer-btn-playing")),a(),clearTimeout(A),A=setTimeout(()=>{w.classList.remove(b("footer-btn-playing"))},500))},m.appendChild(w);const $=g("button");v($,"btn-page-next"),$.classList.add(b("footer-btn")),$.appendChild(pe(R)),$.onclick=function(){r||t(d+1)},m.appendChild($);const C=g("div");v(C,"page-number");const _=g("input");v(_,"page-number-input"),_.value=String(d+1),_.onchange=function(){r||_.value&&t(Number(_.value)-1)};const f=g("span");v(f,"total-page"),f.textContent=" / ",C.appendChild(_),C.appendChild(f),i.appendChild(m),i.appendChild(C);const y=b("readonly");function x(l){r!==l&&(r=l,i.classList.toggle(y,r),_.disabled=r)}function z(l){o!==l&&(o=l,u.style.display=o?"":"none")}function P(l,N=!1){(N||d!==l)&&(d=l,_.value=String(d+1))}function j(l){h!==l&&(h=l,f.textContent=` / ${h}`)}return{$footer:i,$pageNumberInput:_,set_readonly:x,set_sidebar:z,set_page_index:P,set_page_count:j,on_new_page_index:e,on_toggle_preview:n,on_play:p}}function ce(){let t=M;const e=f=>{t=f};let s=!1,n=!1,a=!1,p=[],r=0;const o=b("readonly"),d=b("preview-active"),h=g("div");v(h,"content");const i=g("div");v(i,"preview-mask"),i.onclick=function(y){n||y.target===i&&w(!1)},I(h,i);const u=g("div");v(u,"preview"),u.classList.add(b("tele-fancy-scrollbar")),u.onclick=function(y){var z;if(n)return;const x=(z=y.target.dataset)==null?void 0:z.pageIndex;x&&(y.preventDefault(),y.stopPropagation(),y.stopImmediatePropagation(),t(Number(x)),w(!1))},I(h,u);const m=new Q({container:u,elements_selector:`.${b("preview-page>img")}`});function k(f){n!==f&&(n=f,h.classList.toggle(o,n))}function w(f){a!==f&&(a=f,h.classList.toggle(d,a))}function A(f){if(p!==f){p=f;const y=b("preview-page"),x=b("preview-page-name");p.forEach((z,P)=>{const j=String(P),l=g("a");l.className=y+" "+b(`preview-page-${P}`),l.href="#",l.dataset.pageIndex=j;const N=g("span");N.className=x,N.textContent=String(P+1),N.dataset.pageIndex=j;const L=g("img");L.width=z.width,L.height=z.height,L.src=z.thumbnail,L.alt=`page-${P}`,L.dataset.pageIndex=j,I(l,L),I(l,N),I(u,l)}),s||m.update()}}function $(f,y=!1){if(y||r!==f){r=f;const x=u.querySelector(`.${b(`preview-page-${r}`)}`);x&&u.scrollTo({top:x.offsetTop-16})}}function C(){s=!0,m.destroy()}function _(){return a}return{$content:h,$preview:u,set_readonly:k,set_active:w,get_active:_,set_pages:A,on_new_page_index:e,set_page_index:$,destroy:C}}const T=class{constructor(e){c(this,"sideEffect",new V);c(this,"events",new X);c(this,"$slide",U("div","slide"));c(this,"$overlay",U("div","overlay"));c(this,"sidebar",ce());c(this,"footer",de());c(this,"$content");c(this,"$footer");c(this,"slide");c(this,"_readyPromise");c(this,"_infoPromise");c(this,"_ready",!1);c(this,"_slideCount",0);c(this,"_destroyed",!1);c(this,"_isFrozen",!1);c(this,"_cachedIsFrozen",!1);c(this,"onPlay",()=>{this.slide.nextStep()});c(this,"onNewPageIndex",e=>{this._ready&&e>=0&&e<this._slideCount?this.slide.renderSlide(e+1):this.setPage(this.slide.slideState.currentSlideIndex)});c(this,"onTogglePreview",()=>{this.sidebar.set_active(!this.sidebar.get_active())});this.$content=this.sidebar.$content,this.$footer=this.footer.$footer,I(this.$content,this.$slide),I(this.$content,this.$overlay),this.sidebar.on_new_page_index(this.onNewPageIndex),this.footer.on_new_page_index(this.onNewPageIndex),this.footer.on_toggle_preview(this.onTogglePreview),this.footer.on_play(this.onPlay),this.sideEffect.push(this.sidebar.destroy),this.sideEffect.push(()=>this.slide.destroy()),this.sideEffect.push(()=>{this.$content.parentElement&&this.$content.remove(),this.$footer.parentElement&&this.$footer.remove(),this.$slide.parentElement&&this.$slide.remove()}),this.sideEffect.push(ne(o=>{this._destroyed||(o?this._cachedIsFrozen||this.unfreeze():(this._cachedIsFrozen=this._isFrozen,this.freeze()))}));const[s,n]=O();this._infoPromise=s,T.fetchSlideInfo(e).then(({preview:o,slide:d})=>{if(!this._destroyed){if(this._slideCount=d.slideCount,o){const{taskId:h,url:i}=e,{slideCount:u}=d,{width:m,height:k}=o,w=H(h,i),A=Array.from({length:u},($,C)=>({width:m,height:k,thumbnail:`${w}/preview/${C+1}.png`}));this.sidebar.set_pages(A),this.footer.set_sidebar(!0)}this.footer.set_page_count(d.slideCount),n(d)}}).catch(o=>{console.log("[Slide] fetch slide info error"),console.error(o),this.events.emit("prepareError",o)});const[p,r]=O();this._readyPromise=p,this.slide=new D.Slide({anchor:this.$slide,mode:"local",interactive:!0,enableGlobalClick:!0,useLocalCache:!0,...e}),this.slide.setResource(e.taskId,e.url||G),this.slide.on("slideChange",o=>{this._destroyed||this.setPage(o)}),this.slide.on("renderEnd",()=>{this._ready?this.$overlay.style.opacity="":setTimeout(()=>{this._ready=!0,r()},1e3)}),this.slide.on("renderError",o=>{this._destroyed||o.error&&(console.error(o.error),this.$overlay.textContent=`Error on slide.index=${o.index}: ${o.error.message}`,this.$overlay.style.opacity="1",this.events.emit("renderError",o))}),this.ready(()=>{this._isFrozen&&this.freeze()})}prepare(e){return this._infoPromise.then(e)}ready(e){return this._readyPromise.then(e)}destroy(){this._destroyed=!0,this.sideEffect.flushAll()}setReadonly(e){this.slide.setInteractive(!e),this.sidebar.set_readonly(e),this.footer.set_readonly(e)}setPage(e){this.sidebar.set_page_index(e-1,!0),this.footer.set_page_index(e-1,!0)}freeze(){this._destroyed||(this._isFrozen=!0,this._ready&&(this.slide.frozen(),this.events.emit("freeze")))}unfreeze(){this._destroyed||(this._isFrozen=!1,this._ready&&(this.slide.release(),this.events.emit("unfreeze")))}};let E=T;c(E,"styles",oe),c(E,"fetchSlideInfo",se);function ue(t){return t.displayer.logger}const S=class{constructor(e){c(this,"info",e=>{S.roomLogger&&this.context?S.roomLogger.info(e+` (${this.context.appId})`):this.context?console.debug(e+` (${this.context.appId})`):console.debug(e)});this.context=e,e&&(S.active.add(e.appId),S.roomLogger=ue(e))}destroy(){this.context&&S.active.delete(this.context.appId),S.active.size===0&&(S.roomLogger=null)}};let F=S;c(F,"active",new Set),c(F,"roomLogger",null);function fe({context:t,storage:e,viewer:s,sideEffect:n,logger:a}){const p=a.info.bind(a);let r=null;s.prepare(({width:i,height:u,slideCount:m})=>{t.destroyed||(i&&t.box.setStageRatio(u/i),r=t.createWhiteBoardView({size:m}),r.setBaseRect({width:i,height:u}),h())});const{slide:o}=s;function d(i=e.state.state){return JSON.stringify(i)}function h(){if(e.state.state)p("[Slide] restore "+d()),o.setSlideState(e.state.state);else if(t.isAddApp)p("[Slide] kick start"),o.renderSlide(1);else{p("[Slide] wait for restore");const i=n.add(()=>{const m=setInterval(()=>{e.state.state||(p("[Slide] timeout"),o.renderSlide(1))},15e3);return()=>clearInterval(m)}),u=n.push(e.on("stateChanged",()=>{e.state.state&&(p("[Slide] restore "+d()),o.setSlideState(e.state.state),n.flush(u),n.flush(i))}))}}o.on("stateChange",()=>{t.isWritable&&e.setState({state:o.slideState})}),o.on("syncDispatch",i=>{t.isWritable&&(p("[Slide] dispatch "+d(B(i,"uuid"))),t.dispatchMagixEvent("syncDispatch",i))}),n.push(t.addMagixEventListener("syncDispatch",({payload:i})=>{p("[Slide] receive "+d(B(i,"uuid"))),o.emit("syncReceive",i)},{fireSelfEventAfterCommit:!0})),o.on("slideChange",i=>{t.isWritable&&r&&(p("[Slide] page to "+i),r.jumpPage(i-1))}),s.setReadonly(!t.isWritable),n.push(t.emitter.on("writableChange",i=>{s.setReadonly(!i)})),n.addEventListener(window,"keydown",i=>{t.box.focus&&((i.key==="ArrowUp"||i.key==="ArrowLeft")&&s.slide.prevStep(),(i.key==="ArrowRight"||i.key==="ArrowDown")&&s.slide.nextStep())})}function me(t){const{container:e,...s}=t,n=document.createElement("div");n.className="netless-app-slide-preview-wrapper";const a=new E(s);return n.appendChild(document.createElement("style")).textContent=E.styles,n.appendChild(a.$content),n.appendChild(a.$footer),e.appendChild(n),a.prepare(()=>a.slide.renderSlide(1)),a}const we=D.Slide.usePlugin.bind(D.Slide),ve=void 0,ye={kind:"Slide",setup(t){var o,d;console.log("[Slide] setup @ "+void 0+" ("+t.appId+")");const e=new F(t);if(e.info("[Slide] setup @ "+void 0),!t.attributes.taskId)throw new Error("[Slide] no taskId");const s=t.createStorage("slide",t.attributes),n=t.getAppOptions()||{},a=n.renderOptions||{},p=new V,r=new E({interactive:!0,mode:"interactive",enableGlobalClick:!0,timestamp:ee(t),logger:n.logger||e,renderOptions:{minFPS:a.minFPS||25,maxFPS:a.maxFPS||30,autoFPS:(o=a.autoFPS)!=null?o:!0,autoResolution:(d=a.autoResolution)!=null?d:!0,resolution:a.resolution,maxResolutionLevel:a.maxResolutionLevel,transactionBgColor:a.transactionBgColor||W(t.box.$content)},rtcAudio:n.rtcAudio,useLocalCache:n.useLocalCache,resourceTimeout:n.resourceTimeout,loaderDelegate:n.loaderDelegate,navigatorDelegate:n.navigatorDelegate,fixedFrameSize:n.fixedFrameSize,taskId:s.state.taskId,url:s.state.url});return Object.assign(r,{context:t,logger:e}),p.push(Y.set(t.appId,r)),p.push(r.events.on("freeze",()=>e.info("[Slide] freeze"))),p.push(r.events.on("unfreeze",()=>e.info("[Slide] unfreeze"))),p.push(r.events.on("prepareError",h=>e.info("[Slide] fetch slide info failed: "+h.message))),p.push(r.events.on("renderError",({error:h,index:i})=>e.info(`[Slide] render failed [${i}]: ${h.message}`))),t.box.mountStyles(E.styles),t.box.mountStage(r.$slide),t.box.mountFooter(r.$footer),t.box.mountContent(r.$content),p.push(()=>r.destroy()),fe({context:t,storage:s,viewer:r,sideEffect:p,logger:e}),t.emitter.on("destroy",()=>{e.info("[Slide] destroy"),e.destroy(),p.flushAll()}),r}},_e=D.Slide;export{G as DefaultUrl,_e as Slide,E as SlideViewer,Se as addHooks,ye as default,me as previewSlide,$e as refrigerator,we as usePlugin,ve as version};
